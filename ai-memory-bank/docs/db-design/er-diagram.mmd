erDiagram
  %% ===== PUBLISHER SIDE (Data Producers) =====
  User ||--|| Member : "becomes"
  PublishingOrganization }o--|| Member : "has"
  Role ||--|| Member : "grants"

  PublishingOrganization ||--o{ Resource : "owns"
  Resource ||--|| License : "uses"
  Resource ||--o{ ResourceVersion : "versions"
  ResourceVersion ||--|| ResourceVersionArtifact : "includes"

  %% ===== PROCESSING & DISTRIBUTION =====
  ResourceVersion ||--o{ Asset : "produces"
  Asset ||--o{ AssetVersion : "versions"
  AssetVersion ||--o{ Distribution : "distributed_via"

  %% ===== CONSUMER SIDE (Data Consumers/Developers) =====
  User ||--|| Developer : "acts_as"
  Developer ||--o{ AccessRequest : "creates"
  AccessRequest }o--|| Asset : "targets"
  AccessRequest ||--o| AssetAccess : "when_approved_creates"

  %% ========================================
  %% USER MANAGEMENT & AUTHENTICATION
  %% ========================================
  User {
    uuid id PK
    string email
    string auth_provider
    boolean is_active
    datetime created_at
  }

  %% ========================================
  %% PUBLISHING ORGANIZATIONS & MEMBERSHIP
  %% ========================================
  PublishingOrganization {
    uuid id PK
    string name
    string slug
    string website
  }

  Member {
    uuid id PK
    uuid user_id FK
    uuid org_id FK
    uuid role_id FK
    string status
    datetime joined_at
  }

  Role {
    uuid id PK
    string code
    string name
    string description
  }
  %% V1 will have two main roles:
  %% - Owner: actual owner to register, login to account (Production V2)  
  %% - Manager: Itqan team to access and upload Quranic data from Admin Panel
  %% Later: more members (Auditor, etc.) will be added

  %% ========================================
  %% LICENSING
  %% ========================================
  License {
    uuid id PK
    string code
    string name
    string url
  }

  %% ========================================
  %% RESOURCE & CONTENT MANAGEMENT
  %% ========================================
  Resource {
    uuid id PK
    uuid org_id FK
    uuid default_license_id FK
    string slug
    string title
    string summary
    string status
    uuid latest_version_id FK
    datetime created_at
    datetime updated_at
  }

  ResourceVersion {
    uuid id PK
    uuid resource_id FK
    string semver
    string changelog
    boolean processed
    string api_endpoint
    string docs_url
    datetime created_at
  }

  ResourceVersionArtifact {
    uuid id PK
    uuid version_id FK
    string storage_key
    string file_type
    int size_bytes
    string checksum
    datetime created_at
  }

  %% ========================================
  %% ASSET PROCESSING & DISTRIBUTION
  %% ========================================
  Asset {
    uuid id PK
    uuid version_id FK
    string api_slug
    string visibility
    datetime created_at
  }

  AssetVersion {
    uuid id PK
    uuid asset_id FK
    string semver
    string api_path
    string package_name
    string docs_url
    datetime created_at
  }

  Distribution {
    uuid id PK
    uuid asset_version_id FK
    string distribution_type
    string endpoint_url
    string package_name
    string package_version
    boolean is_active
    datetime created_at
  }

  %% ========================================
  %% DEVELOPER (CONSUMER) PROFILE
  %% ========================================
  Developer {
    uuid id PK
    uuid user_id FK
    string handle
    string bio
    string github_url
    datetime created_at
  }

  %% ========================================
  %% ACCESS CONTROL & CONSUMPTION
  %% ========================================
  AccessRequest {
    uuid id PK
    uuid developer_id FK
    uuid asset_id FK
    string status
    string justification
    uuid decided_by FK
    datetime decided_at
    datetime created_at
  }

  AssetAccess {
    uuid id PK
    uuid access_request_id FK
    uuid developer_id FK
    uuid asset_version_id FK
    string access_type
    uuid token_id FK
    datetime granted_at
  }


