{
  "prompt": "You are an autonomous coding agent completing STORY-2: Email Verification enforcement for Itqan CMS. Block dashboard access until Auth0 email_verified is true and mirror status in Strapi user profile.",
  "context": {
    "project": "Itqan CMS",
    "feature": "Email Verification",
    "auth_model": "Auth0 Hybrid (Hosted Universal Login)",
    "tech_stack": ["Next.js 14", "Strapi v5"],
    "screens": ["REG-002"],
    "colors": {"primary": "#669B80", "dark": "#22433D"}
  },
  "objectives": [
    "Enforce verified email",
    "Sync email_verified flag to Strapi",
    "Display resend-verification UI"
  ],
  "tasks": [
    "Enable Email Verification in Auth0 tenant with Hosted Universal Login",
    "Configure Auth0 Universal Login page to show verification message",
    "Add post-login action to include email_verified in ID token",
    "Build REG-002 screen: verification status page with Itqan branding",
    "On Next.js callback, if email_verified=false redirect to /verify-email",
    "Expose endpoint /api/auth/verification-status to poll",
    "Add Strapi user attribute emailVerified",
    "Implement resend verification link via Auth0 Management API"
  ],
  "guard_rails": [
    "No dashboard API access until verified",
    "Rate-limit resend links"
  ],
  "acceptance_criteria": [
    "Unverified user sees verification screen",
    "After clicking link, refresh grants dashboard"
  ],
  "definition_of_done": [
    "E2E test automates verify flow",
    "Story marked completed"
  ],
  "out_of_scope": [
    "Password reset",
    "Multi-factor auth"
  ],
  "references": [
    "BRD ยง3.1",
    "Auth0 docs",
    "Screen REG-002: Email verification confirmation page",
    "English wireframe: ai-memory-bank/tasks/screens/en/create_english_wireframes.html#REG-002"
  ]
}