{
  "prompt": "You are an autonomous coding agent completing STORY-16: Email Notifications for Itqan CMS. Implement email system for user registration confirmations, workflow approvals, license requests, and system notifications using SMTP configuration.",
  "context": {
    "project": "Itqan CMS",
    "feature": "Email Notification System",
    "tech_stack": ["Strapi v5", "Email provider", "Template engine"],
    "notification_types": ["Registration", "Workflow transitions", "License requests", "System alerts"]
  },
  "objectives": [
    "Configure SMTP email provider in Strapi",
    "Create email templates for different notification types",
    "Implement automated emails for user registration and workflow events",
    "Set up admin notifications for important system events"
  ],
  "tasks": [
    "Configure email provider plugin in Strapi with SMTP settings",
    "Create email templates for registration welcome and verification",
    "Implement workflow transition emails (draft submitted, review approved, etc.)",
    "Create license request notification emails for publishers",
    "Set up admin alert emails for system events and errors",
    "Add email template management interface in admin",
    "Implement email queue for reliable delivery",
    "Create bilingual email templates (English/Arabic)",
    "Add email preferences and unsubscribe functionality",
    "Test email delivery and template rendering"
  ],
  "guard_rails": [
    "All emails must include unsubscribe links for compliance",
    "Email templates must be responsive for mobile devices",
    "Sensitive information should not be included in email content",
    "Email sending should not block API requests (use queue)",
    "Failed email deliveries should be logged and retried"
  ],
  "acceptance_criteria": [
    "Given a user registers, then they receive welcome email in their preferred language",
    "Given content workflow changes, then relevant users receive notification emails",
    "Given license request is submitted, then publisher receives notification email",
    "Email templates render correctly in major email clients",
    "Users can manage email preferences and unsubscribe from notifications"
  ],
  "definition_of_done": [
    "Email system configured and sending notifications reliably",
    "All email templates created and tested in both languages",
    "Email queue handling delivery failures and retries",
    "Admin interface for managing email templates and settings",
    "Email delivery monitoring and error logging implemented"
  ],
  "out_of_scope": [
    "Advanced email marketing features",
    "Integration with external email service providers beyond SMTP",
    "Email analytics and open rate tracking"
  ],
  "references": [
    "docs/Itqan_CMS_BRD.md ยง3.7 Notifications",
    "env.dev.example EMAIL_* configuration variables",
    "Strapi email plugin documentation",
    "Screen ADMIN-007: Email template editor with EN/AR bilingual support",
    "English wireframe: ai-memory-bank/tasks/screens/en/final_wireframes.html#ADMIN-007"
  ]
}
