{
  "prompt": "Add Angular Universal SSR capability to existing CSR application with TransferState for hydration and SEO optimization",
  "context": {
    "project": "Itqan CMS",
    "feature": "Angular Universal SSR Toggle",
    "auth_model": "SSR-compatible authentication handling",
    "tech_stack": ["Angular Universal", "SSR", "TransferState", "Node.js", "Express"],
    "screens": [],
    "colors": {"primary": "#669B80", "dark": "#22433D"}
  },
  "objectives": [
    "Add Angular Universal to existing CSR application",
    "Configure TransferState for API data hydration",
    "Implement SSR-compatible authentication flow",
    "Setup conditional rendering for client/server differences",
    "Create SSR deployment configuration"
  ],
  "tasks": [
    "Install Angular Universal and configure SSR build",
    "Add Express server configuration for SSR",
    "Implement TransferState for API data transfer",
    "Update Auth0 service for SSR compatibility",
    "Configure conditional rendering for browser-specific features",
    "Setup prerendering for static routes",
    "Create SSR-compatible routing and lazy loading",
    "Update deployment scripts for SSR build"
  ],
  "guard_rails": [
    "Maintain CSR functionality as fallback",
    "Ensure SSR doesn't break existing features",
    "Handle authentication state properly in SSR",
    "Avoid server-side DOM manipulation",
    "Test both CSR and SSR modes thoroughly"
  ],
  "acceptance_criteria": [
    "Application renders correctly on server-side",
    "Client hydration works without flickering",
    "Authentication flow compatible with SSR",
    "SEO meta tags populated correctly",
    "Performance improved for initial page load"
  ],
  "definition_of_done": [
    "SSR build generates successfully",
    "Server-side rendering functional for all routes",
    "Client-side hydration seamless",
    "SEO improvements measurable",
    "Both CSR and SSR modes deployable"
  ],
  "out_of_scope": [
    "Advanced prerendering strategies",
    "Service worker integration",
    "Advanced caching strategies",
    "Performance monitoring beyond basic metrics"
  ],
  "references": [
    "Angular Universal documentation",
    "TransferState API guide",
    "SSR best practices for SPAs",
    "Express server configuration for Angular"
  ]
}
