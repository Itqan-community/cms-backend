<!-- Article List Component - PUB-001 -->
<div class="article-list-page">
  <!-- Header Section -->
  <div class="page-header">
    <nz-breadcrumb>
      <nz-breadcrumb-item>
        <a routerLink="/">{{ i18n.t()('navigation.home') }}</a>
      </nz-breadcrumb-item>
      <nz-breadcrumb-item>
        <span>{{ i18n.t()('navigation.articles') }}</span>
      </nz-breadcrumb-item>
    </nz-breadcrumb>
    
    <h1 nz-typography>{{ i18n.t()('articles.title') }}</h1>
    <p nz-typography>{{ i18n.t()('articles.subtitle') }}</p>
  </div>

  <!-- Featured Articles Section -->
  <section class="featured-section" *ngIf="featuredArticles().length > 0">
    <h2 nz-typography>{{ i18n.t()('articles.featured') }}</h2>
    
    <div nz-row [nzGutter]="[16, 16]">
      <!-- Main Featured Article -->
      <div nz-col [nzXs]="24" [nzSm]="24" [nzMd]="16" *ngIf="getFirstFeaturedArticle() as featured">
        <nz-card 
          class="featured-main-card"
          [nzCover]="featuredCover"
          [nzActions]="[readMoreAction]"
          (click)="navigateToArticle(featured)">
          
          <ng-template #featuredCover>
            <div class="featured-image">
              <img 
                [src]="featured.metadata?.featured_image || '/assets/images/default-article.jpg'"
                [alt]="getLocalizedTitle(featured)"
                loading="lazy">
              <div class="featured-overlay">
                <nz-tag [nzColor]="getResourceTypeColor(featured.resource_type)">
                  <nz-icon [nzType]="getResourceTypeIcon(featured.resource_type)"></nz-icon>
                  {{ featured.resource_type }}
                </nz-tag>
              </div>
            </div>
          </ng-template>

          <nz-card-meta
            [nzTitle]="getLocalizedTitle(featured)"
            [nzDescription]="formatExcerpt(featured)">
          </nz-card-meta>

          <div class="article-meta">
            <span class="author">
              <nz-icon nzType="user"></nz-icon>
              {{ featured.publisher_name }}
            </span>
            <span class="date">
              <nz-icon nzType="calendar"></nz-icon>
              {{ formatDate(featured.published_at) }}
            </span>
            <span class="language">
              {{ getLanguageFlag(featured.language) }}
              {{ featured.language_display }}
            </span>
          </div>

          <ng-template #readMoreAction>
            <nz-icon nzType="read"></nz-icon>
            {{ i18n.t()('articles.read_more') }}
          </ng-template>
        </nz-card>
      </div>

      <!-- Other Featured Articles -->
      <div nz-col [nzXs]="24" [nzSm]="24" [nzMd]="8">
        <div class="featured-sidebar">
          <nz-card 
            *nzFor="let article of getOtherFeaturedArticles()"
            class="featured-side-card"
            [nzSize]="'small'"
            (click)="navigateToArticle(article)">
            
            <div class="side-article">
              <div class="side-content">
                <h4>{{ getLocalizedTitle(article) }}</h4>
                <p>{{ formatExcerpt(article, 80) }}</p>
                <div class="side-meta">
                  <span>{{ formatDate(article.published_at) }}</span>
                  <nz-tag [nzSize]="'small'" [nzColor]="getResourceTypeColor(article.resource_type)">
                    {{ article.resource_type }}
                  </nz-tag>
                </div>
              </div>
            </div>
          </nz-card>
        </div>
      </div>
    </div>
  </section>

  <nz-divider></nz-divider>

  <!-- Filter and Search Section -->
  <section class="filter-section">
    <nz-card>
      <form nz-form [formGroup]="filterForm" (ngSubmit)="onSearch()">
        <div nz-row [nzGutter]="[16, 16]">
          <!-- Search Input -->
          <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8">
            <nz-input-group [nzSuffix]="searchIcon">
              <input 
                nz-input 
                formControlName="search"
                [placeholder]="i18n.t()('articles.search_placeholder')"
                (keyup.enter)="onSearch()">
            </nz-input-group>
            <ng-template #searchIcon>
              <button nz-button nzType="text" nzSize="small" (click)="onSearch()">
                <nz-icon nzType="search"></nz-icon>
              </button>
            </ng-template>
          </div>

          <!-- Category Filter -->
          <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="4">
            <nz-select 
              formControlName="category"
              [nzPlaceHolder]="i18n.t()('articles.all_categories')"
              nzAllowClear>
              <nz-option 
                *nzFor="let category of categories()" 
                [nzValue]="category" 
                [nzLabel]="category">
              </nz-option>
            </nz-select>
          </div>

          <!-- Language Filter -->
          <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="4">
            <nz-select 
              formControlName="language"
              [nzPlaceHolder]="i18n.t()('articles.all_languages')">
              <nz-option 
                *nzFor="let lang of languageOptions" 
                [nzValue]="lang.value" 
                [nzLabel]="lang.label">
              </nz-option>
            </nz-select>
          </div>

          <!-- Resource Type Filter -->
          <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="4">
            <nz-select 
              formControlName="resource_type"
              [nzPlaceHolder]="i18n.t()('articles.all_types')">
              <nz-option 
                *nzFor="let type of resourceTypeOptions" 
                [nzValue]="type.value" 
                [nzLabel]="type.label">
              </nz-option>
            </nz-select>
          </div>

          <!-- Sort Order -->
          <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="4">
            <nz-select 
              formControlName="ordering"
              [nzPlaceHolder]="i18n.t()('articles.sort_by')">
              <nz-option 
                *nzFor="let sort of sortOptions" 
                [nzValue]="sort.value" 
                [nzLabel]="sort.label">
              </nz-option>
            </nz-select>
          </div>
        </div>

        <!-- Clear Filters Button -->
        <div class="filter-actions">
          <button nz-button nzType="default" (click)="onClearFilters()">
            <nz-icon nzType="clear"></nz-icon>
            {{ i18n.t()('articles.clear_filters') }}
          </button>
        </div>
      </form>
    </nz-card>
  </section>

  <!-- Articles Grid Section -->
  <section class="articles-section">
    <!-- Loading State -->
    <div *ngIf="loading()" class="loading-section">
      <div nz-row [nzGutter]="[16, 16]">
        <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8" [nzLg]="6" *nzFor="let i of [1,2,3,4,5,6,7,8]">
          <nz-card>
            <nz-skeleton [nzActive]="true" [nzAvatar]="true"></nz-skeleton>
          </nz-card>
        </div>
      </div>
    </div>

    <!-- Articles Grid -->
    <div *ngIf="!loading() && articles().length > 0" class="articles-grid">
      <div nz-row [nzGutter]="[16, 16]">
        <div 
          nz-col 
          [nzXs]="24" 
          [nzSm]="12" 
          [nzMd]="8" 
          [nzLg]="6"
          *nzFor="let article of articles(); trackBy: trackByArticleId">
          
          <nz-card 
            class="article-card"
            [nzCover]="articleCover"
            [nzActions]="[viewAction]"
            (click)="navigateToArticle(article)">
            
            <ng-template #articleCover>
              <div class="article-image">
                <img 
                  [src]="article.metadata?.featured_image || '/assets/images/default-article.jpg'"
                  [alt]="getLocalizedTitle(article)"
                  loading="lazy">
                <div class="article-overlay">
                  <nz-tag [nzColor]="getResourceTypeColor(article.resource_type)" [nzSize]="'small'">
                    <nz-icon [nzType]="getResourceTypeIcon(article.resource_type)"></nz-icon>
                    {{ article.resource_type }}
                  </nz-tag>
                </div>
              </div>
            </ng-template>

            <nz-card-meta
              [nzTitle]="getLocalizedTitle(article)"
              [nzDescription]="formatExcerpt(article)">
            </nz-card-meta>

            <div class="article-footer">
              <div class="article-meta">
                <span class="author">
                  <nz-avatar [nzSize]="16" nzIcon="user"></nz-avatar>
                  {{ article.publisher_name }}
                </span>
                <span class="date">
                  <nz-icon nzType="calendar"></nz-icon>
                  {{ formatDate(article.published_at) }}
                </span>
              </div>
              
              <div class="article-tags" *ngIf="article.metadata?.tags">
                <nz-tag 
                  *nzFor="let tag of article.metadata.tags.slice(0, 2)" 
                  [nzSize]="'small'"
                  (click)="onTagClick(tag); $event.stopPropagation()">
                  {{ tag }}
                </nz-tag>
              </div>
            </div>

            <ng-template #viewAction>
              <nz-icon nzType="eye"></nz-icon>
              {{ i18n.t()('articles.view') }}
            </ng-template>
          </nz-card>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading() && articles().length === 0" class="empty-section">
      <nz-empty 
        [nzNotFoundContent]="i18n.t()('articles.no_articles_found')"
        [nzNotFoundImage]="'simple'">
        <nz-empty-footer>
          <button nz-button nzType="primary" (click)="onClearFilters()">
            {{ i18n.t()('articles.clear_filters_and_try_again') }}
          </button>
        </nz-empty-footer>
      </nz-empty>
    </div>

    <!-- Pagination -->
    <div *ngIf="!loading() && articles().length > 0" class="pagination-section">
      <nz-pagination
        [nzPageIndex]="currentPage()"
        [nzTotal]="totalArticles()"
        [nzPageSize]="pageSize()"
        [nzShowSizeChanger]="true"
        [nzPageSizeOptions]="[12, 24, 36, 48]"
        [nzShowQuickJumper]="true"
        [nzShowTotal]="totalTemplate"
        (nzPageIndexChange)="onPageChange($event)"
        (nzPageSizeChange)="onPageSizeChange($event)">
      </nz-pagination>

      <ng-template #totalTemplate let-total let-range="range">
        {{ i18n.t()('articles.showing_results', { start: range[0], end: range[1], total: total }) }}
      </ng-template>
    </div>
  </section>

  <!-- Quick Categories Section -->
  <section class="quick-categories" *ngIf="categories().length > 0">
    <nz-card>
      <h3 nz-typography>{{ i18n.t()('articles.browse_by_category') }}</h3>
      <div class="category-tags">
        <nz-tag 
          *nzFor="let category of categories()" 
          class="category-tag"
          [nzColor]="'processing'"
          (click)="onCategoryClick(category)">
          <nz-icon nzType="folder"></nz-icon>
          {{ category }}
        </nz-tag>
      </div>
    </nz-card>
  </section>
</div>
